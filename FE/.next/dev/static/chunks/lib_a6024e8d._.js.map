{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/khach2/electric-car/FE/lib/api.ts"],"sourcesContent":["import type {\r\n  Product,\r\n  ProductsResponse,\r\n  Category,\r\n  CategoriesResponse,\r\n  CategoryProductsResponse,\r\n  Cart,\r\n  CartResponse,\r\n  Order,\r\n  OrdersResponse,\r\n  Review,\r\n  ReviewsResponse,\r\n  CheckoutResponse,\r\n  User,\r\n} from \"./types\"\r\n\r\nconst API_BASE_URL = process.env.NEXT_PUBLIC_API_BASE_URL || \"http://localhost:5000\"\r\n\r\ninterface ApiError {\r\n  msg?: string\r\n}\r\n\r\nasync function fetchApi<T>(endpoint: string, options: RequestInit = {}): Promise<T> {\r\n  const url = `${API_BASE_URL}${endpoint}`\r\n  \r\n  const defaultHeaders: HeadersInit = {\r\n    \"Content-Type\": \"application/json\",\r\n  }\r\n\r\n  const config: RequestInit = {\r\n    ...options,\r\n    headers: {\r\n      ...defaultHeaders,\r\n      ...options.headers,\r\n    },\r\n    credentials: \"include\",\r\n  }\r\n\r\n  const response = await fetch(url, config)\r\n\r\n  if (!response.ok) {\r\n    const error: ApiError = await response.json().catch(() => ({ msg: \"Có lỗi xảy ra\" }))\r\n    throw new Error(error.msg || `HTTP error! status: ${response.status}`)\r\n  }\r\n\r\n  return response.json()\r\n}\r\n\r\n// Products API\r\nexport const productsApi = {\r\n  getAll: (): Promise<ProductsResponse> => fetchApi<ProductsResponse>(\"/api/v1/products\"),\r\n  \r\n  getById: (id: string): Promise<{ product: Product }> =>\r\n    fetchApi<{ product: Product }>(`/api/v1/products/${id}`),\r\n  \r\n  getReviews: (id: string): Promise<ReviewsResponse> =>\r\n    fetchApi<ReviewsResponse>(`/api/v1/products/${id}/reviews`),\r\n}\r\n\r\n// Categories API\r\nexport const categoriesApi = {\r\n  getAll: (): Promise<CategoriesResponse> =>\r\n    fetchApi<CategoriesResponse>(\"/api/v1/public/categories\"),\r\n  \r\n  getProductsByCategory: (slug: string): Promise<CategoryProductsResponse> =>\r\n    fetchApi<CategoryProductsResponse>(`/api/v1/public/categories/${slug}/products`),\r\n}\r\n\r\n// Cart API\r\nexport const cartApi = {\r\n  get: (): Promise<CartResponse> => fetchApi<CartResponse>(\"/api/v1/cart\"),\r\n  \r\n  addItem: (productId: string, quantity: number, color: string): Promise<CartResponse> =>\r\n    fetchApi<CartResponse>(\"/api/v1/cart\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify({ productId, quantity, color }),\r\n    }),\r\n  \r\n  updateItem: (productId: string, color: string, quantity: number): Promise<CartResponse> =>\r\n    fetchApi<CartResponse>(\"/api/v1/cart\", {\r\n      method: \"PATCH\",\r\n      body: JSON.stringify({ productId, color, quantity }),\r\n    }),\r\n  \r\n  removeItem: (productId: string, color: string): Promise<CartResponse> =>\r\n    fetchApi<CartResponse>(\"/api/v1/cart/item\", {\r\n      method: \"DELETE\",\r\n      body: JSON.stringify({ productId, color }),\r\n    }),\r\n  \r\n  clear: (): Promise<CartResponse> =>\r\n    fetchApi<CartResponse>(\"/api/v1/cart\", {\r\n      method: \"DELETE\",\r\n    }),\r\n}\r\n\r\n// Auth API\r\nexport const authApi = {\r\n  register: (data: {\r\n    name: string\r\n    email: string\r\n    password: string\r\n    phone?: string\r\n    address?: string\r\n    avatar?: string\r\n    gender?: string\r\n    dateOfBirth?: string\r\n  }): Promise<{ user: User; msg?: string }> =>\r\n    fetchApi<{ user: User; msg?: string }>(\"/api/v1/auth/register\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(data),\r\n    }),\r\n  \r\n  login: (email: string, password: string): Promise<{ user: User; msg: string }> =>\r\n    fetchApi<{ user: User; msg: string }>(\"/api/v1/auth/login\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify({ email, password }),\r\n    }),\r\n  \r\n  logout: (): Promise<{ msg: string }> =>\r\n    fetchApi<{ msg: string }>(\"/api/v1/auth/logout\", {\r\n      method: \"GET\",\r\n    }),\r\n}\r\n\r\n// Orders API\r\nexport const ordersApi = {\r\n  getAll: (): Promise<OrdersResponse> => fetchApi<OrdersResponse>(\"/api/v1/orders\"),\r\n  \r\n  getMyOrders: (): Promise<OrdersResponse> =>\r\n    fetchApi<OrdersResponse>(\"/api/v1/orders/showAllMyOrders\"),\r\n  \r\n  getById: (id: string): Promise<{ order: Order }> =>\r\n    fetchApi<{ order: Order }>(`/api/v1/orders/${id}`),\r\n}\r\n\r\n// Checkout API\r\nexport const checkoutApi = {\r\n  createOrder: (data: {\r\n    discountCode?: string\r\n    paymentMethod?: string\r\n    userPhone?: string\r\n    shippingAddress?: string\r\n  }): Promise<CheckoutResponse> =>\r\n    fetchApi<CheckoutResponse>(\"/api/v1/checkout/vnpay\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(data),\r\n    }),\r\n}\r\n\r\n// Reviews API\r\nexport const reviewsApi = {\r\n  create: (data: {\r\n    product: string\r\n    rating: number\r\n    title: string\r\n    comment: string\r\n  }): Promise<{ review: Review }> =>\r\n    fetchApi<{ review: Review }>(\"/api/v1/reviews\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify(data),\r\n    }),\r\n  \r\n  getAll: (): Promise<ReviewsResponse> => fetchApi<ReviewsResponse>(\"/api/v1/reviews\"),\r\n  \r\n  getById: (id: string): Promise<{ review: Review }> =>\r\n    fetchApi<{ review: Review }>(`/api/v1/reviews/${id}`),\r\n  \r\n  update: (id: string, data: { rating?: number; title?: string; comment?: string }): Promise<{ msg: string }> =>\r\n    fetchApi<{ msg: string }>(`/api/v1/reviews/${id}`, {\r\n      method: \"PATCH\",\r\n      body: JSON.stringify(data),\r\n    }),\r\n  \r\n  delete: (id: string): Promise<{ msg: string }> =>\r\n    fetchApi<{ msg: string }>(`/api/v1/reviews/${id}`, {\r\n      method: \"DELETE\",\r\n    }),\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAgBqB;AAArB,MAAM,eAAe,8DAAwC;AAM7D,eAAe,SAAY,QAAgB,EAAE,UAAuB,CAAC,CAAC;IACpE,MAAM,MAAM,GAAG,eAAe,UAAU;IAExC,MAAM,iBAA8B;QAClC,gBAAgB;IAClB;IAEA,MAAM,SAAsB;QAC1B,GAAG,OAAO;QACV,SAAS;YACP,GAAG,cAAc;YACjB,GAAG,QAAQ,OAAO;QACpB;QACA,aAAa;IACf;IAEA,MAAM,WAAW,MAAM,MAAM,KAAK;IAElC,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,QAAkB,MAAM,SAAS,IAAI,GAAG,KAAK,CAAC,IAAM,CAAC;gBAAE,KAAK;YAAgB,CAAC;QACnF,MAAM,IAAI,MAAM,MAAM,GAAG,IAAI,CAAC,oBAAoB,EAAE,SAAS,MAAM,EAAE;IACvE;IAEA,OAAO,SAAS,IAAI;AACtB;AAGO,MAAM,cAAc;IACzB,QAAQ,IAAiC,SAA2B;IAEpE,SAAS,CAAC,KACR,SAA+B,CAAC,iBAAiB,EAAE,IAAI;IAEzD,YAAY,CAAC,KACX,SAA0B,CAAC,iBAAiB,EAAE,GAAG,QAAQ,CAAC;AAC9D;AAGO,MAAM,gBAAgB;IAC3B,QAAQ,IACN,SAA6B;IAE/B,uBAAuB,CAAC,OACtB,SAAmC,CAAC,0BAA0B,EAAE,KAAK,SAAS,CAAC;AACnF;AAGO,MAAM,UAAU;IACrB,KAAK,IAA6B,SAAuB;IAEzD,SAAS,CAAC,WAAmB,UAAkB,QAC7C,SAAuB,gBAAgB;YACrC,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAW;gBAAU;YAAM;QACpD;IAEF,YAAY,CAAC,WAAmB,OAAe,WAC7C,SAAuB,gBAAgB;YACrC,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAW;gBAAO;YAAS;QACpD;IAEF,YAAY,CAAC,WAAmB,QAC9B,SAAuB,qBAAqB;YAC1C,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAW;YAAM;QAC1C;IAEF,OAAO,IACL,SAAuB,gBAAgB;YACrC,QAAQ;QACV;AACJ;AAGO,MAAM,UAAU;IACrB,UAAU,CAAC,OAUT,SAAuC,yBAAyB;YAC9D,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IAEF,OAAO,CAAC,OAAe,WACrB,SAAsC,sBAAsB;YAC1D,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;gBAAE;gBAAO;YAAS;QACzC;IAEF,QAAQ,IACN,SAA0B,uBAAuB;YAC/C,QAAQ;QACV;AACJ;AAGO,MAAM,YAAY;IACvB,QAAQ,IAA+B,SAAyB;IAEhE,aAAa,IACX,SAAyB;IAE3B,SAAS,CAAC,KACR,SAA2B,CAAC,eAAe,EAAE,IAAI;AACrD;AAGO,MAAM,cAAc;IACzB,aAAa,CAAC,OAMZ,SAA2B,0BAA0B;YACnD,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;AACJ;AAGO,MAAM,aAAa;IACxB,QAAQ,CAAC,OAMP,SAA6B,mBAAmB;YAC9C,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IAEF,QAAQ,IAAgC,SAA0B;IAElE,SAAS,CAAC,KACR,SAA6B,CAAC,gBAAgB,EAAE,IAAI;IAEtD,QAAQ,CAAC,IAAY,OACnB,SAA0B,CAAC,gBAAgB,EAAE,IAAI,EAAE;YACjD,QAAQ;YACR,MAAM,KAAK,SAAS,CAAC;QACvB;IAEF,QAAQ,CAAC,KACP,SAA0B,CAAC,gBAAgB,EAAE,IAAI,EAAE;YACjD,QAAQ;QACV;AACJ"}},
    {"offset": {"line": 131, "column": 0}, "map": {"version":3,"sources":["file:///D:/khach2/electric-car/FE/lib/error-handler.ts"],"sourcesContent":["export function getErrorMessage(error: unknown): string {\r\n  if (error instanceof Error) {\r\n    return error.message\r\n  }\r\n  return \"Đã xảy ra lỗi không xác định\"\r\n}\r\n\r\nexport function handleApiError(error: unknown, defaultMessage: string): Error {\r\n  const message = getErrorMessage(error)\r\n  return new Error(message || defaultMessage)\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAO,SAAS,gBAAgB,KAAc;IAC5C,IAAI,iBAAiB,OAAO;QAC1B,OAAO,MAAM,OAAO;IACtB;IACA,OAAO;AACT;AAEO,SAAS,eAAe,KAAc,EAAE,cAAsB;IACnE,MAAM,UAAU,gBAAgB;IAChC,OAAO,IAAI,MAAM,WAAW;AAC9B"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///D:/khach2/electric-car/FE/lib/storage.ts"],"sourcesContent":["const USER_STORAGE_KEY = \"user\"\r\n\r\nexport const storage = {\r\n  getUser: (): string | null => {\r\n    if (typeof window === \"undefined\") return null\r\n    return localStorage.getItem(USER_STORAGE_KEY)\r\n  },\r\n\r\n  setUser: (user: string): void => {\r\n    if (typeof window === \"undefined\") return\r\n    localStorage.setItem(USER_STORAGE_KEY, user)\r\n  },\r\n\r\n  removeUser: (): void => {\r\n    if (typeof window === \"undefined\") return\r\n    localStorage.removeItem(USER_STORAGE_KEY)\r\n  },\r\n}\r\n"],"names":[],"mappings":";;;;AAAA,MAAM,mBAAmB;AAElB,MAAM,UAAU;IACrB,SAAS;QACP;;QACA,OAAO,aAAa,OAAO,CAAC;IAC9B;IAEA,SAAS,CAAC;QACR;;QACA,aAAa,OAAO,CAAC,kBAAkB;IACzC;IAEA,YAAY;QACV;;QACA,aAAa,UAAU,CAAC;IAC1B;AACF"}},
    {"offset": {"line": 183, "column": 0}, "map": {"version":3,"sources":["file:///D:/khach2/electric-car/FE/lib/auth-context.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { createContext, useContext, useState, useEffect, useCallback, useMemo, type ReactNode } from \"react\"\r\nimport { authApi } from \"./api\"\r\nimport { storage } from \"./storage\"\r\nimport { handleApiError } from \"./error-handler\"\r\nimport type { User } from \"./types\"\r\n\r\ninterface AuthContextType {\r\n  user: User | null\r\n  isLoading: boolean\r\n  login: (email: string, password: string) => Promise<void>\r\n  register: (data: {\r\n    name: string\r\n    email: string\r\n    password: string\r\n    phone?: string\r\n    address?: string\r\n  }) => Promise<void>\r\n  logout: () => Promise<void>\r\n  isAuthenticated: boolean\r\n  isAdmin: boolean\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\r\n\r\nfunction parseUser(userString: string): User | null {\r\n  try {\r\n    return JSON.parse(userString) as User\r\n  } catch {\r\n    return null\r\n  }\r\n}\r\n\r\nfunction saveUser(user: User): void {\r\n  storage.setUser(JSON.stringify(user))\r\n}\r\n\r\nfunction clearUser(): void {\r\n  storage.removeUser()\r\n}\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n  const [user, setUser] = useState<User | null>(null)\r\n  const [isLoading, setIsLoading] = useState(true)\r\n\r\n  useEffect(() => {\r\n    const checkAuth = () => {\r\n      const savedUser = storage.getUser()\r\n      if (savedUser) {\r\n        const parsedUser = parseUser(savedUser)\r\n        if (parsedUser) {\r\n          setUser(parsedUser)\r\n        }\r\n      }\r\n      setIsLoading(false)\r\n    }\r\n\r\n    checkAuth()\r\n  }, [])\r\n\r\n  const login = useCallback(async (email: string, password: string) => {\r\n    try {\r\n      const response = await authApi.login(email, password)\r\n      setUser(response.user)\r\n      saveUser(response.user)\r\n    } catch (error) {\r\n      throw handleApiError(error, \"Đăng nhập thất bại\")\r\n    }\r\n  }, [])\r\n\r\n  const register = useCallback(\r\n    async (data: {\r\n      name: string\r\n      email: string\r\n      password: string\r\n      phone?: string\r\n      address?: string\r\n    }) => {\r\n      try {\r\n        const response = await authApi.register(data)\r\n        setUser(response.user)\r\n        saveUser(response.user)\r\n      } catch (error) {\r\n        throw handleApiError(error, \"Đăng ký thất bại\")\r\n      }\r\n    },\r\n    []\r\n  )\r\n\r\n  const logout = useCallback(async () => {\r\n    try {\r\n      await authApi.logout()\r\n    } catch (error) {\r\n      console.error(\"Logout failed:\", error)\r\n    } finally {\r\n      setUser(null)\r\n      clearUser()\r\n    }\r\n  }, [])\r\n\r\n  const isAuthenticated = useMemo(() => !!user, [user])\r\n  const isAdmin = useMemo(() => user?.role === \"admin\", [user])\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        isLoading,\r\n        login,\r\n        register,\r\n        logout,\r\n        isAuthenticated,\r\n        isAdmin,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  )\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext)\r\n  if (!context) {\r\n    throw new Error(\"useAuth must be used within an AuthProvider\")\r\n  }\r\n  return context\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AACA;;;AALA;;;;;AAwBA,MAAM,4BAAc,IAAA,6SAAa,EAA8B;AAE/D,SAAS,UAAU,UAAkB;IACnC,IAAI;QACF,OAAO,KAAK,KAAK,CAAC;IACpB,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEA,SAAS,SAAS,IAAU;IAC1B,4HAAO,CAAC,OAAO,CAAC,KAAK,SAAS,CAAC;AACjC;AAEA,SAAS;IACP,4HAAO,CAAC,UAAU;AACpB;AAEO,SAAS,aAAa,EAAE,QAAQ,EAA2B;;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,wSAAQ,EAAc;IAC9C,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,wSAAQ,EAAC;IAE3C,IAAA,ySAAS;kCAAC;YACR,MAAM;oDAAY;oBAChB,MAAM,YAAY,4HAAO,CAAC,OAAO;oBACjC,IAAI,WAAW;wBACb,MAAM,aAAa,UAAU;wBAC7B,IAAI,YAAY;4BACd,QAAQ;wBACV;oBACF;oBACA,aAAa;gBACf;;YAEA;QACF;iCAAG,EAAE;IAEL,MAAM,QAAQ,IAAA,2SAAW;2CAAC,OAAO,OAAe;YAC9C,IAAI;gBACF,MAAM,WAAW,MAAM,wHAAO,CAAC,KAAK,CAAC,OAAO;gBAC5C,QAAQ,SAAS,IAAI;gBACrB,SAAS,SAAS,IAAI;YACxB,EAAE,OAAO,OAAO;gBACd,MAAM,IAAA,4IAAc,EAAC,OAAO;YAC9B;QACF;0CAAG,EAAE;IAEL,MAAM,WAAW,IAAA,2SAAW;8CAC1B,OAAO;YAOL,IAAI;gBACF,MAAM,WAAW,MAAM,wHAAO,CAAC,QAAQ,CAAC;gBACxC,QAAQ,SAAS,IAAI;gBACrB,SAAS,SAAS,IAAI;YACxB,EAAE,OAAO,OAAO;gBACd,MAAM,IAAA,4IAAc,EAAC,OAAO;YAC9B;QACF;6CACA,EAAE;IAGJ,MAAM,SAAS,IAAA,2SAAW;4CAAC;YACzB,IAAI;gBACF,MAAM,wHAAO,CAAC,MAAM;YACtB,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,kBAAkB;YAClC,SAAU;gBACR,QAAQ;gBACR;YACF;QACF;2CAAG,EAAE;IAEL,MAAM,kBAAkB,IAAA,uSAAO;iDAAC,IAAM,CAAC,CAAC;gDAAM;QAAC;KAAK;IACpD,MAAM,UAAU,IAAA,uSAAO;yCAAC,IAAM,MAAM,SAAS;wCAAS;QAAC;KAAK;IAE5D,qBACE,4TAAC,YAAY,QAAQ;QACnB,OAAO;YACL;YACA;YACA;YACA;YACA;YACA;YACA;QACF;kBAEC;;;;;;AAGP;GA7EgB;KAAA;AA+ET,SAAS;;IACd,MAAM,UAAU,IAAA,0SAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANgB"}},
    {"offset": {"line": 317, "column": 0}, "map": {"version":3,"sources":["file:///D:/khach2/electric-car/FE/lib/cart-context.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { createContext, useContext, useState, useEffect, useCallback, useMemo, type ReactNode } from \"react\"\r\nimport { cartApi } from \"./api\"\r\nimport { handleApiError } from \"./error-handler\"\r\nimport type { CartItem, Product } from \"./types\"\r\nimport { useAuth } from \"./auth-context\"\r\n\r\ninterface CartContextType {\r\n  items: CartItem[]\r\n  addItem: (product: Product, quantity: number, color: string) => Promise<void>\r\n  removeItem: (productId: string, color: string) => Promise<void>\r\n  updateQuantity: (productId: string, color: string, quantity: number) => Promise<void>\r\n  clearCart: () => Promise<void>\r\n  refreshCart: () => Promise<void>\r\n  total: number\r\n  itemCount: number\r\n  isLoading: boolean\r\n}\r\n\r\nconst CartContext = createContext<CartContextType | undefined>(undefined)\r\n\r\nconst AUTH_REQUIRED_MESSAGE = \"Vui lòng đăng nhập\"\r\n\r\nexport function CartProvider({ children }: { children: ReactNode }) {\r\n  const [items, setItems] = useState<CartItem[]>([])\r\n  const [isLoading, setIsLoading] = useState(true)\r\n  const { isAuthenticated } = useAuth()\r\n\r\n  const refreshCart = useCallback(async () => {\r\n    if (!isAuthenticated) {\r\n      setItems([])\r\n      setIsLoading(false)\r\n      return\r\n    }\r\n\r\n    try {\r\n      setIsLoading(true)\r\n      const response = await cartApi.get()\r\n      setItems(response.cart.items || [])\r\n    } catch (error) {\r\n      console.error(\"Failed to fetch cart:\", error)\r\n      setItems([])\r\n    } finally {\r\n      setIsLoading(false)\r\n    }\r\n  }, [isAuthenticated])\r\n\r\n  useEffect(() => {\r\n    refreshCart()\r\n  }, [refreshCart])\r\n\r\n  const addItem = useCallback(\r\n    async (product: Product, quantity: number, color: string) => {\r\n      if (!isAuthenticated) {\r\n        throw new Error(`${AUTH_REQUIRED_MESSAGE} để thêm sản phẩm vào giỏ hàng`)\r\n      }\r\n\r\n      try {\r\n        await cartApi.addItem(product._id, quantity, color)\r\n        await refreshCart()\r\n      } catch (error) {\r\n        throw handleApiError(error, \"Không thể thêm sản phẩm vào giỏ hàng\")\r\n      }\r\n    },\r\n    [isAuthenticated, refreshCart]\r\n  )\r\n\r\n  const removeItem = useCallback(\r\n    async (productId: string, color: string) => {\r\n      if (!isAuthenticated) {\r\n        throw new Error(AUTH_REQUIRED_MESSAGE)\r\n      }\r\n\r\n      try {\r\n        await cartApi.removeItem(productId, color)\r\n        await refreshCart()\r\n      } catch (error) {\r\n        throw handleApiError(error, \"Không thể xóa sản phẩm\")\r\n      }\r\n    },\r\n    [isAuthenticated, refreshCart]\r\n  )\r\n\r\n  const updateQuantity = useCallback(\r\n    async (productId: string, color: string, quantity: number) => {\r\n      if (!isAuthenticated) {\r\n        throw new Error(AUTH_REQUIRED_MESSAGE)\r\n      }\r\n\r\n      if (quantity <= 0) {\r\n        await removeItem(productId, color)\r\n        return\r\n      }\r\n\r\n      try {\r\n        await cartApi.updateItem(productId, color, quantity)\r\n        await refreshCart()\r\n      } catch (error) {\r\n        throw handleApiError(error, \"Không thể cập nhật số lượng\")\r\n      }\r\n    },\r\n    [isAuthenticated, refreshCart, removeItem]\r\n  )\r\n\r\n  const clearCart = useCallback(async () => {\r\n    if (!isAuthenticated) {\r\n      setItems([])\r\n      return\r\n    }\r\n\r\n    try {\r\n      await cartApi.clear()\r\n      await refreshCart()\r\n    } catch (error) {\r\n      console.error(\"Failed to clear cart:\", error)\r\n    }\r\n  }, [isAuthenticated, refreshCart])\r\n\r\n  const total = useMemo(() => items.reduce((sum, item) => sum + item.price * item.quantity, 0), [items])\r\n  const itemCount = useMemo(() => items.reduce((sum, item) => sum + item.quantity, 0), [items])\r\n\r\n  return (\r\n    <CartContext.Provider\r\n      value={{\r\n        items,\r\n        addItem,\r\n        removeItem,\r\n        updateQuantity,\r\n        clearCart,\r\n        refreshCart,\r\n        total,\r\n        itemCount,\r\n        isLoading,\r\n      }}\r\n    >\r\n      {children}\r\n    </CartContext.Provider>\r\n  )\r\n}\r\n\r\nexport function useCart() {\r\n  const context = useContext(CartContext)\r\n  if (!context) {\r\n    throw new Error(\"useCart must be used within a CartProvider\")\r\n  }\r\n  return context\r\n}\r\n"],"names":[],"mappings":"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"}}]
}